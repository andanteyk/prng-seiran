# `seiran` æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆå™¨

[English version is here.](README.md)

LFSRãƒ™ãƒ¼ã‚¹ã®æ–°ã—ã„æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆå™¨ã‚’ææ¡ˆã™ã‚‹ã€‚

## æœ€å°å®Ÿè£… (Cè¨€èª)

```c
uint64_t rotl(uint64_t x, int k) { return (x << k) | (x >> (-k & 63)); }
// state ã¯ {0, 0} ä»¥å¤–ã®å€¤ã§åˆæœŸåŒ–ã™ã‚‹ã“ã¨
uint64_t next(uint64_t state[2]) {
	uint64_t s0 = state[0], s1 = state[1];
	uint64_t result = rotl((s0 + s1) * 9, 29) + s0;
	state[0] = s0 ^ rotl(s1, 29);
	state[1] = s0 ^ s1 << 9;
	return result;
}
```

è©³ã—ãã¯ `seiran128.c` ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã€‚

## åˆ©ç‚¹

1. 64 bit ç’°å¢ƒã§é«˜é€Ÿã«å®Ÿè¡Œå¯èƒ½ã€‚
	* 64 bit ç‰ˆãƒ¡ãƒ«ã‚»ãƒ³ãƒŒãƒ„ã‚¤ã‚¹ã‚¿ã®ç´„ 3.7 å€ã®é€Ÿåº¦ã§å®Ÿè¡Œå¯èƒ½ã€‚
1. ç§»æ¤æ€§ãŒé«˜ã„ã€‚å®Ÿè£…ãŒå®¹æ˜“ã§ã‚ã‚‹ã€‚
	* 128 bit ä¹—ç®—ãªã©ã€ç’°å¢ƒãƒ»è¨€èªä¾å­˜ã®å‘½ä»¤ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ã€‚
1. å‘¨æœŸã¯ 2^128 - 1 ã€‚æ•°å­¦çš„ã«è¨¼æ˜å¯èƒ½ã€‚
	* ã‚²ãƒ¼ãƒ ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨é€”ã§ã¯ååˆ†ã§ã‚ã‚‹ã€‚
1. å‡ºåŠ›ã¯ 1 æ¬¡å…ƒå‡ç­‰åˆ†å¸ƒã™ã‚‹ã€‚64 bit æ•´æ•°ã®ã™ã¹ã¦ã®å€¤ãŒã»ã¼ç­‰ç¢ºç‡ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚
1. ä½å“è³ªã®ãƒ“ãƒƒãƒˆä½ç½®ãŒå­˜åœ¨ã—ãªã„ã€‚
	* ç·šå½¢åˆåŒæ³•ã®ã‚ˆã†ã«ã€ä¸‹ä½ãƒ“ãƒƒãƒˆã®ä¹±æ•°æ€§ãŒä½ã„å•é¡ŒãŒå­˜åœ¨ã—ãªã„ã€‚
1. ç©ºé–“åˆ©ç”¨åŠ¹ç‡ãŒè‰¯ã„ã€‚
	* 128 bit == 16 byte ã®å†…éƒ¨çŠ¶æ…‹é ˜åŸŸã®ã¿ã‚’ç”¨ã„ã‚‹ã€‚
1. å¤šãã®å¼·åŠ›ãªä¹±æ•°æ€§ãƒ†ã‚¹ãƒˆã«ãƒ‘ã‚¹ã™ã‚‹ã€‚  
	(ä»¥ä¸‹ã§ã¯ã€rev ã¯å‡ºåŠ›ã®ãƒ“ãƒƒãƒˆé †ã‚’é€†è»¢ã•ã›ãŸã‚‚ã®ã€std ã¯å‡ºåŠ›ã‚’ãã®ã¾ã¾ç”¨ã„ãŸã‚‚ã®ã‚’è¡¨ã™ã€‚)
	* [PractRand](http://pracrand.sourceforge.net/) v0.94 expanded extra ( `-tf 2 -te 1` ) 32TB: no anomalies in 2417 test result(s)
	* [Hamming-weight dependencies](http://prng.di.unimi.it/hwd.php) 1PB: p = 0.581
	* [TestU01](http://simul.iro.umontreal.ca/testu01/tu01.html) v.1.2.3 BigCrush std/rev: ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦ p in [1e-10, 1 - 1e-10]
	* [gjrand](http://gjrand.sourceforge.net/) v4.2.1.0
		* testunif 10T ( `--ten-tera` ): p = std 0.369 / rev 0.276
		* testfunif 1T ( `--tera` ): p = std 0.574 / rev 0.145
1. ã‚¸ãƒ£ãƒ³ãƒ—æ©Ÿèƒ½ã‚’æŒã¡ã€ä¸¦åˆ—å®Ÿè¡ŒãŒå®¹æ˜“ã€‚
	* 2^64 å›ã® `next()` å‘¼ã³å‡ºã—ã¨åŒç­‰ã®æ“ä½œãŒå®šæ•°æ™‚é–“ã§å¯èƒ½ã€‚
	* é‡è¤‡ã—ãªã„ã€é•·ã• 2^64 ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒ 2^64 æœ¬ä½¿ç”¨ã§ãã‚‹ã“ã¨ã«ãªã‚‹ã€‚

## æ¬ ç‚¹

1. æš—å·è«–çš„æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆå™¨ã§ã¯ãªã„ã€‚
	* æš—å·åŒ–ãƒ»éµç”Ÿæˆãªã©ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åº¦ã‚’è¦ã™ã‚‹å ´åˆã«ã¯çµ¶å¯¾ã«ä½¿ç”¨ã—ã¦ã¯ãªã‚‰ãªã„ã€‚
	* 3 ã¤ã®é€£ç¶šã—ãŸ 64 bit ã®å‡ºåŠ›ã‹ã‚‰ã€[Z3 ã‚½ãƒ«ãƒ](https://github.com/Z3Prover/z3) ã‚’ç”¨ã„ã¦å†…éƒ¨çŠ¶æ…‹ã®å¾©å…ƒã‚’è©¦ã¿ãŸã¨ã“ã‚ã€æ•°åˆ†ã§å¾©å…ƒã«æˆåŠŸã—ãŸã€‚
1. 32 bit ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒªã‚¢ãƒ³ãƒˆãŒå­˜åœ¨ã—ãªã„ã€‚
1. æ–°ã—ã„ãŸã‚ã€ä»–è€…ã«ã‚ˆã‚‹èª¿æŸ»ãŒãªã•ã‚Œã¦ã„ãªã„ã€‚

## æ¯”è¼ƒ

ä¸»è¦ãª 64bit å‡ºåŠ›ã®æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆå™¨ã¨ã®æ¯”è¼ƒã‚’ä»¥ä¸‹ã«ç¤ºã™ã€‚

|åå‰|å‘¨æœŸ|ã‚µã‚¤ã‚º(byte)|å‡ç­‰åˆ†å¸ƒæ¬¡å…ƒ|å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆ|é€Ÿåº¦(64bit/ns)|
|:---|---:|---:|---:|:---|---:|
|[`sfc64`](http://pracrand.sourceforge.net/)|> 2^64|32|0|-|1.21|
|ğŸ‘‰ `seiran128`|2^128 - 1|16|1|-|1.20|
|[`xoroshiro128+`](http://xoshiro.di.unimi.it/xoroshiro128plus.c)|2^128 - 1|16|1|BRank, hwd|1.13|
|[`shioi128`](https://github.com/andanteyk/prng-shioi)|2^128 - 1|16|1|-|1.00|
|[`xoshiro256**`](http://xoshiro.di.unimi.it/xoshiro256starstar.c)|2^256 - 1|32|4|-|0.99|
|[`lehmer128`](https://web.archive.org/web/20180609040734/http://xoshiro.di.unimi.it/lehmer128.c) (ç·šå½¢åˆåŒæ³•)|2^126|16|1|TMFn|0.74|
|[`splitmix`](http://xoshiro.di.unimi.it/splitmix64.c)|2^64|8|1|-|0.68|
|[`pcg64_xsh_rr`](http://www.pcg-random.org/)|2^128|16|1|-|0.38|
|[`mt19937_64`](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/C-LANG/mt19937-64.c) (Mersenne Twister)|2^19937 - 1|2500|311|BRank|0.32|
|[`tinymt64`](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/TINYMT/index-jp.html)|2^127 - 1|16|1|BRank, hwd|0.24|

é€Ÿåº¦æ¸¬å®šã§ã¯ [xoshiro/xoroshiro ã§ç”¨ã„ã‚‰ã‚ŒãŸãƒãƒ¼ãƒã‚¹](http://xoshiro.di.unimi.it/harness.c) ã‚’ä½¿ç”¨ã—ã€`Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz / gcc 7.3.0` ç’°å¢ƒä¸‹ã§å®Ÿæ–½ã—ãŸã€‚  
ç’°å¢ƒã‚„çŠ¶æ³ã«ã‚ˆã£ã¦é€Ÿåº¦ã¯ç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
[Public Domain (CC0)](https://creativecommons.org/publicdomain/zero/1.0/)
